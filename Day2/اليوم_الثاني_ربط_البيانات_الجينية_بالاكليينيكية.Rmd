---
title: 'ุงูููู ุงูุซุงูู: '
output:
  html_document:
    lang: ar
    css: ../sc/style.css
    df_print: paged
  pdf_document: default
editor_options:
  markdown:
    wrap: sentence
---

--

# ูุงูู ูููุงุช MAFุ

<br><br>

ููู **MAF** ูู ุงุฎุชุตุงุฑ ูู **Mutation Annotation Format**ุ ููู ุตูุบุฉ ูููุงุช ููุงุณูุฉ ุชูุณุชุฎุฏู ุจุดูู ูุงุณุน ูู ุงููุนูููุงุชูุฉ ุงูุญูููุฉ (Bioinformatics) ูุชุฎุฒูู ูุชูุซูู ุจูุงูุงุช ุงูุทูุฑุงุช ุงูุฌูููุฉ ุงูููุชุดูุฉ ูู ุงูุฏุฑุงุณุงุช ุงูุฌูููููุฉุ ุฎุตูุตูุง ูู ูุฌุงู ุฃุจุญุงุซ ุงูุณุฑุทุงู.

ููุนุชุจุฑ ููู ุงูู MAF ุชูุณูููุง ุฌุฏููููุง (ุฌุฏูู ูุตู ููุตูู ุจููุงุตู ุฃู ุชุจููุจุงุช) ูุถู ูุนูููุงุช ูุตููุฉ ุนู ูู ุทูุฑุฉ ุฌูููุฉุ ุจุญูุซ ูุชูุญ ููุจุงุญุซูู ุชุจุงุฏู ุงูุจูุงูุงุช ูุชุญููููุง ุจุทุฑููุฉ ููุญูุฏุฉ ูููุธูุฉ.

**๐ ุงููุญุชููุงุช ุงูุฃุณุงุณูุฉ ูููู MAF:**

โช๏ธ **Gene Symbol (ุฑูุฒ ุงูุฌูู)**: ุงุณู ุงูุฌูู ุงูุฐู ุญุฏุซุช ููู ุงูุทูุฑุฉ.

โช๏ธ **Chromosome (ุงููุฑูููุณูู)**: ูููุน ุงูุทูุฑุฉ ุนูู ุงููุฑูููุณูู.

โช๏ธ **Start/End Position (ููุถุน ุงูุจุฏุงูุฉ ูุงูููุงูุฉ):** ุงููููุน ุงูุฌููููู ููุทูุฑุงุช.

โช๏ธ **Variant Classification (ุชุตููู ุงูุทูุฑุฉ):** ูุญุฏุฏ ููุน ุงูุทูุฑุฉ (ูุซู: Silentุ Missenseุ Nonsenseุ Frame-shift...).

โช๏ธ **Variant Type (ููุน ุงูุชุบูุฑ):** ูุซู SNP (ุชุนุฏุฏ ุฃุดูุงู ุงูููููููุชูุฏุงุช ุงูููุฑุฏุฉ) ุฃู Insertion ุฃู Deletion.

โช๏ธ **Reference & Tumor Allele (ุงูุฃููู ุงููุฑุฌุนู ูุฃููู ุงููุฑู):** ููุงุฑูุฉ ุจูู ุงูุชุณูุณู ุงููุฑุฌุนู ูุงูุชุบูุฑ ุงููุฑุตูุฏ.

โช๏ธ **Sample Information (ูุนูููุงุช ุงูุนููุฉ):** ูุซู ุงููุฑูุถุ ููุน ุงููุณูุฌ (ูุฑูู ุฃู ุทุจูุนู).

ููุทูู ุงูุขู ููุนูู ุนูู ูุฐุง ุงูููู!

<br><br>

------------------------------------------------------------------------

## 1. ุณูููู ุจุชููุฆุฉ ุจูุฆุฉ ุงูุนููุ ุซู ูุญููู ุงูุญุฒู ุงูุจุฑูุฌูุฉ ุงูุชู ุณูุญุชุงุฌ ุฅูููุง ุฃุซูุงุก ูุฐู ุงููุฑุดุฉ.

<br><br>

```{r Setting up the environment}

library(maftools)
library(dplyr)
library(skimr)
library(tidyverse)
library(ggplot2)
```
<br><br>

## 2. ูููู ุจูุฑุงุกุฉ ููู ุงูุจูุงูุงุช ุงููุตููุฉ ุงูุฐู ุชู ุญูุธู ูู ุงูููู ุงูุฃูู

<br><br>


``` {r load metadata}

url <- "https://raw.githubusercontent.com/Dalah-Info/health-info-bioinformatics-r/refs/heads/main/Day1/Breast_tumor_metadata_cleaned.csv"
Breast_tumor_metadata = read.csv(url)

```

<br><br>


## 3. ูููู ุจูุฑุงุกุฉ ููู ุงูุทูุฑุงุช ุงูุฌูููุฉ: MFA

<br><br>


``` {r load maf file}

url2 <- "https://github.com/Dalah-Info/health-info-bioinformatics-r/raw/refs/heads/main/maf_file/filtered_maf_breast_only_maftools.maf.gz"
maf_file = read.maf(maf = url2)

```
<br><br>

## 4. ูุณุชูุดู ุดูู ููู MAF ูุงูุจูุงูุงุช ุงููุณุฌูุฉ ููู

<br><br>


``` {r explore maf file}

head(maf_file@data) #ุงูุจูุงูุงุช ุงููุตููุฉ ูุฌุฏูุง ูู ูุฐู ุงูุฎุงูุฉ


```

ูููู ุจุงุณุชุฎุฏุงู ุฃุฏุงุฉ **skimr** ูุชูุฑุฃ ููุง ุงูููู ูุงููุง

``` {r skim maf file}

skim(maf_file@data) 

```

<br><br>

## 5. ุฏูุฌ ููู ุงูุจูุงูุงุช ุงููุตููุฉ ูุงูุงูููููููุฉ ูุน ููู MAF

<br><br>

**ููุงุฐุงุ ๐ด**

ุนุงุฏุฉ ูุง ูุฃุชู ููู MAF ูููุตูุง ุนู ุงูููู ุงููุตููุ ููุญุชุงุฌ ูุฏูุฌููุง ูุนูุง ุญุชู ูุชููู ูู ุชุญููู ุงูุทูุฑุงุช ูุฑุจุทูุง ุจูุฐู ุงูุจูุงูุงุช.

**ูููุ ๐ด**

ูุญุชุงุฌ ุฅูู ุนููุฏ ูุงุญุฏ ูุดุชุฑู ุจูู ุงููููููุ ุนุงุฏุฉ ูููู ุฑูุฒ ุงูุนููุฉ


**ุฃูู ูุฌุฏ ุฑูุฒ ุงูุนููุฉุ ๐ด**

ูู ููู MAFุ ููุงู ููุทุงู ูู ุชุฑููุฒ ุงูุนููุงุช (Sample Barcoding) ูุฌุจ ุงูุงูุชุจุงู ูููุง:

1) ููุท TCGA

2) ููุท UUID

ุงุฎุชุฑ ุงูููุท ุงูููุฌูุฏ ูู ููู ุงูู MAF ูุฃูุถูุง ูู ุงูุจูุงูุงุช ุงููุตููุฉ (Metadata)ุ ุญุชู ุชุชููู ูู ุฑุจุท ุงูุฌุฏูููู ุจุงุณุชุฎุฏุงู ูุฐุง ุงูุนููุฏ.


``` {r patient ID in MAF file}

head(unique(maf_file@data$Tumor_Sample_UUID), 5) #ูุงููุฌุฏ ูุฏุฎูุงุช

head(unique(maf_file@data$Tumor_Sample_Barcode),5)

```
<br><br>

ุณูู ูุฎุชุงุฑ ุฑูุฒ TCGA ูุฃู UUID ุบูุฑ ููุฌูุฏ ูู ููู ุงูู MAF.

**๐ด ุฑูุฒ ุงูุนููุฉ ูู ููู MAF:**

*TCGA-OL-A66K-01A-11D-A29N-09* ูู ุฑูุฒ ูุงูู ููุนููุฉ (sample/aliquot barcode).
ููุชูููู ูู:

โช๏ธ TCGA โ ุงููุดุฑูุน (Project)

โช๏ธ OL โ ูููุน ูุตุฏุฑ ุงููุณูุฌ (Tissue Source Site - TSS)

โช๏ธ A66K โ ูุนุฑูู ุงููุดุงุฑู (ุงููุฑูุถ) (Participant/Patient ID)

โช๏ธ 01A โ ููุน ุงูุนููุฉ + ุงููุงุฑูุฑุฉ (01 = ูุฑู ุฃููู "Primary tumor" ุ A = ูุงุฑูุฑุฉ)

โช๏ธ 11D โ ุงูุฌุฒุก + ุงููุญูู ุงูุญููู (11 = ุฌุฒุกุ D = DNA)

โช๏ธ A29N โ ุงูุตููุญุฉ (Plate)

โช๏ธ 09 โ ุงููุฑูุฒ (Center)


ูู ุชูุฌุฏ ูุฐู ุงูุจูุงูุงุช ูู ููู ุงูุจูุงูุงุช ุงููุตููุฉุ ููุชุญูู ูู ุฐูู

<br><br>

``` {r explore patient ID in metadata}

head(unique(Breast_tumor_metadata$bcr_patient_barcode),5)

```
<br><br>

**๐ดุฑูุฒ ุงูุนููุฉ ูู ุงูุจูุงูุงุช ุงููุตููุฉ (Metadata):**

ูุฏููุง ููุท ุฑูุฒ ุงููุฑูุถ (Patient Barcode) ูุซู:
*TCGA-EW-A6S9*ุ ููู ูุชููู ููุท ูู ุฃูู 12 ุญุฑููุง ูู ุฑูุฒ ุงูู TCGA ุงููุงูู ุงูููุฌูุฏ ูู ููู MAF.

โ ุฅุฐู ุงููุงุนุฏุฉ ูู:
**ุฑูุฒ ุงููุฑูุถ ูู ุงูููู ุงููุตูู = ุฃูู 12 ุญุฑู ูู ุฑูุฒ ุงูุนููุฉ ูู ููู MAF**.

<br><br>

```{r get unique patient ID}

#ูุณุชุฎูุต ุชุฑููุฒุงุช ุงููุฑุถู ุงูููุฌูุฏุฉ ูู ููู ูุงู
maf_patuent_ids <- unique(as.character(maf_file@data$Tumor_Sample_Barcode))

#ูุณุชูุทุน ุฃูู 12 ุญุฑู ูููุงุ ููู ุนุจุงุฑุฉ ุนู ุฑูุฒ ุงููุฑูุถ
maf_patient_ids <- substr(maf_patuent_ids, 1, 12)

# ูููู ุจุชุตููุฉ ููู ุงูุจูุงูุงุช ุงููุตููุฉุ ุญุชู ูุญุฐู ููู ุฃู ูุฑูุถ ูุง ุชูุฌุฏ ูุฏููุง ูุนูููุงุชู ูู ููู ูุงู
matched_clinical_data <- Breast_tumor_metadata[Breast_tumor_metadata$bcr_patient_barcode %in% maf_patient_ids, ]


#ููุดุฆ ุนููุฏ ุฌุฏูุฏ ูู ููู ุงูุจูุงูุงุช ุงููุตููุฉุ ูุญูู ููุณ ุงุณู ุงูุนููุฏ ุงูููุฌูุฏ ูู ููู ูุงู (ูุชุฑููุฒู ุฃูุถุง)
matched_clinical_data$Tumor_Sample_Barcode <- matched_clinical_data$bcr_patient_barcode

#ูุจุงูุชุงูู ุฃุตุจุญ ูุฏููุง ุนููุฏ ูุดุชุฑู ุจูู ุงูููููู ููููููุง ุงูุขู ุฏูุฌููุง ูู ููู ูุงุญุฏ!

```

<br><br>

**โ ูุณุชุทูุน ุงูุขู ุฅูุดุงุก ููู MAF ููุชููุ ูุญุชูู ุนูู ุงูุจูุงูุงุช ุงููุตููุฉ ุงูุฅูููููููุฉ:**

<br><br>


```{r integrate maf and metadata file}

maf_file <- read.maf(maf = url2, clinicalData = matched_clinical_data, verbose = F)

```


