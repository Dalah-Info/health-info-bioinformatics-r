---
title: "ุงูููู ุงูุซุงูู: ุชุญููู ุงูุจูุงูุงุช ุงูุฌูููุฉ ูุฑุจุทูุง ุจุงูุจูุงูุงุช ุงูุฅูููููููุฉ"
lang: ar
output:
  html_document:
    css: ../sc/style.css
    df_print: paged
  pdf_document: default
editor_options:
  markdown:
    wrap: sentence
---


# ูุงูู ูููุงุช MAFุ

<br><br>

ููู **MAF** ูู ุงุฎุชุตุงุฑ ูู **Mutation Annotation Format**ุ ููู ุตูุบุฉ ูููุงุช ููุงุณูุฉ ุชูุณุชุฎุฏู ุจุดูู ูุงุณุน ูู ุงููุนูููุงุชูุฉ ุงูุญูููุฉ (Bioinformatics) ูุชุฎุฒูู ูุชูุซูู ุจูุงูุงุช ุงูุทูุฑุงุช ุงูุฌูููุฉ ุงูููุชุดูุฉ ูู ุงูุฏุฑุงุณุงุช ุงูุฌูููููุฉุ ุฎุตูุตูุง ูู ูุฌุงู ุฃุจุญุงุซ ุงูุณุฑุทุงู.

ููุนุชุจุฑ ููู ุงูู MAF ุชูุณูููุง ุฌุฏููููุง (ุฌุฏูู ูุตู ููุตูู ุจููุงุตู ุฃู ุชุจููุจุงุช) ูุถู ูุนูููุงุช ูุตููุฉ ุนู ูู ุทูุฑุฉ ุฌูููุฉุ ุจุญูุซ ูุชูุญ ููุจุงุญุซูู ุชุจุงุฏู ุงูุจูุงูุงุช ูุชุญููููุง ุจุทุฑููุฉ ููุญูุฏุฉ ูููุธูุฉ.

**๐ ุงููุญุชููุงุช ุงูุฃุณุงุณูุฉ ูููู MAF:**

โช๏ธ **Gene Symbol (ุฑูุฒ ุงูุฌูู)**: ุงุณู ุงูุฌูู ุงูุฐู ุญุฏุซุช ููู ุงูุทูุฑุฉ.

โช๏ธ **Chromosome (ุงููุฑูููุณูู)**: ูููุน ุงูุทูุฑุฉ ุนูู ุงููุฑูููุณูู.

โช๏ธ **Start/End Position (ููุถุน ุงูุจุฏุงูุฉ ูุงูููุงูุฉ):** ุงููููุน ุงูุฌููููู ููุทูุฑุงุช.

โช๏ธ **Variant Classification (ุชุตููู ุงูุทูุฑุฉ):** ูุญุฏุฏ ููุน ุงูุทูุฑุฉ (ูุซู: Silentุ Missenseุ Nonsenseุ Frame-shift...).

โช๏ธ **Variant Type (ููุน ุงูุชุบูุฑ):** ูุซู SNP (ุชุนุฏุฏ ุฃุดูุงู ุงูููููููุชูุฏุงุช ุงูููุฑุฏุฉ) ุฃู Insertion ุฃู Deletion.

โช๏ธ **Reference & Tumor Allele (ุงูุฃููู ุงููุฑุฌุนู ูุฃููู ุงููุฑู):** ููุงุฑูุฉ ุจูู ุงูุชุณูุณู ุงููุฑุฌุนู ูุงูุชุบูุฑ ุงููุฑุตูุฏ.

โช๏ธ **Sample Information (ูุนูููุงุช ุงูุนููุฉ):** ูุซู ุงููุฑูุถุ ููุน ุงููุณูุฌ (ูุฑูู ุฃู ุทุจูุนู).

ููุทูู ุงูุขู ููุนูู ุนูู ูุฐุง ุงูููู!

<br><br>

___

## 1. ุณูููู ุจุชููุฆุฉ ุจูุฆุฉ ุงูุนููุ ุซู ูุญููู ุงูุญุฒู ุงูุจุฑูุฌูุฉ ุงูุชู ุณูุญุชุงุฌ ุฅูููุง ุฃุซูุงุก ูุฐู ุงููุฑุดุฉ.

<br><br>

```{r Setting up the environment}

library(maftools)
library(dplyr)
library(skimr)
library(tidyverse)
library(ggplot2)
library(data.table)
library(ggrepel)


```

<br><br>

## 2. ูููู ุจูุฑุงุกุฉ ููู ุงูุจูุงูุงุช ุงููุตููุฉ ุงูุฐู ุชู ุญูุธู ูู ุงูููู ุงูุฃูู

<br><br>

```{r load metadata}

url <- "https://raw.githubusercontent.com/Dalah-Info/health-info-bioinformatics-r/refs/heads/main/Day1/Breast_tumor_metadata_cleaned.csv"
Breast_tumor_metadata = read.csv(url,  row.names = NULL)

```

<br><br>

## 3. ูููู ุจูุฑุงุกุฉ ููู ุงูุทูุฑุงุช ุงูุฌูููุฉ: MFA

<br><br>

```{r load maf file}

url2 <- "https://github.com/Dalah-Info/health-info-bioinformatics-r/raw/refs/heads/main/maf_file/filtered_maf_breast_only_maftools.maf.gz"
maf_file = read.maf(maf = url2)

```

<br><br>

## 4. ูุณุชูุดู ุดูู ููู MAF ูุงูุจูุงูุงุช ุงููุณุฌูุฉ ููู

```{r explore maf file}

head(maf_file@data) #ุงูุจูุงูุงุช ุงููุตููุฉ ููุญููุงุช ูุฌุฏูุง ูู ูุฐู ุงูุฎุงูุฉ


```

ูููู ุจุงุณุชุฎุฏุงู ุฃุฏุงุฉ **skimr** ูุชูุฑุฃ ููุง ุงูููู ุงููุตูู ูุงููุง

```{r skim maf file}

skim(maf_file@data) 

```

<br><br>

## 5. ุฏูุฌ ููู ุงูุจูุงูุงุช ุงููุตููุฉ ูุงูุงูููููููุฉ ูุน ููู MAF

<br><br>

**ููุงุฐุงุ ๐ด**

ุนุงุฏุฉ ูุง ูุฃุชู ููู MAF ูููุตูุง ุนู ุงูููู ุงููุตููุ ููุญุชุงุฌ ูุฏูุฌููุง ูุนูุง ุญุชู ูุชููู ูู ุชุญููู ุงูุทูุฑุงุช ูุฑุจุทูุง ุจูุฐู ุงูุจูุงูุงุช.

**ูููุ ๐ด**

ูุญุชุงุฌ ุฅูู ุนููุฏ ูุงุญุฏ ูุดุชุฑู ุจูู ุงููููููุ ุนุงุฏุฉ ูููู ุฑูุฒ ุงูุนููุฉ

**ุฃูู ูุฌุฏ ุฑูุฒ ุงูุนููุฉุ ๐ด**

ูู ููู MAFุ ููุงู ููุทุงู ูู ุชุฑููุฒ ุงูุนููุงุช (Sample Barcoding) ูุฌุจ ุงูุงูุชุจุงู ูููุง:

1)  ููุท TCGA

2)  ููุท UUID

ุงุฎุชุฑ ุงูููุท ุงูููุฌูุฏ ูู ููู ุงูู MAF ูุฃูุถูุง ูู ุงูุจูุงูุงุช ุงููุตููุฉ (Metadata)ุ ุญุชู ุชุชููู ูู ุฑุจุท ุงูุฌุฏูููู ุจุงุณุชุฎุฏุงู ูุฐุง ุงูุนููุฏ.

```{r patient ID in MAF file}

head(unique(maf_file@data$Tumor_Sample_UUID), 5) #ูุงููุฌุฏ ูุฏุฎูุงุช

head(unique(maf_file@data$Tumor_Sample_Barcode),5)

```

<br><br>

ุณูู ูุฎุชุงุฑ ุฑูุฒ TCGA ูุฃู UUID ุบูุฑ ููุฌูุฏ ูู ููู ุงูู MAF.

**๐ด ุฑูุฒ ุงูุนููุฉ ูู ููู MAF:**

*TCGA-OL-A66K-01A-11D-A29N-09* ูู ุฑูุฒ ูุงูู ููุนููุฉ (sample/aliquot barcode).
ููุชูููู ูู:

โช๏ธ TCGA โ ุงููุดุฑูุน (Project)

โช๏ธ OL โ ูููุน ูุตุฏุฑ ุงููุณูุฌ (Tissue Source Site - TSS)

โช๏ธ A66K โ ูุนุฑูู ุงููุดุงุฑู (ุงููุฑูุถ) (Participant/Patient ID)

โช๏ธ 01A โ ููุน ุงูุนููุฉ + ุงููุงุฑูุฑุฉ (01 = ูุฑู ุฃููู "Primary tumor" ุ A = ูุงุฑูุฑุฉ)

โช๏ธ 11D โ ุงูุฌุฒุก + ุงููุญูู ุงูุญููู (11 = ุฌุฒุกุ D = DNA)

โช๏ธ A29N โ ุงูุตููุญุฉ (Plate)

โช๏ธ 09 โ ุงููุฑูุฒ (Center)

ูู ุชูุฌุฏ ูุฐู ุงูุจูุงูุงุช ูู ููู ุงูุจูุงูุงุช ุงููุตููุฉุ ููุชุญูู ูู ุฐูู

<br><br>

```{r explore patient ID in metadata}

head(unique(Breast_tumor_metadata$bcr_patient_barcode),5)

```

<br><br>

**๐ดุฑูุฒ ุงูุนููุฉ ูู ุงูุจูุงูุงุช ุงููุตููุฉ (Metadata):**

ูุฏููุง ููุท ุฑูุฒ ุงููุฑูุถ (Patient Barcode) ูุซู: *TCGA-EW-A6S9*ุ ููู ูุชููู ููุท ูู ุฃูู 12 ุญุฑููุง ูู ุฑูุฒ ุงูู TCGA ุงููุงูู ุงูููุฌูุฏ ูู ููู MAF.

โ ุฅุฐู ุงููุงุนุฏุฉ ูู: **ุฑูุฒ ุงููุฑูุถ ูู ุงูููู ุงููุตูู = ุฃูู 12 ุญุฑู ูู ุฑูุฒ ุงูุนููุฉ ูู ููู MAF**.

<br><br>

```{r get unique patient ID}

#ููุดุฆ ููู ุจูุงูุงุช ูุญุชูู ุนูู ุงูุฑูุฒ ุงูุทููู ูุงููุตูุฑ ูููุฑูุถุ ููุณุชุฎุฏูู ูุงุญูุง ููุฏูุฌ.

id_map <- data.frame(
  short_id = substr(maf_file@data$Tumor_Sample_Barcode, 1, 12),             # ูุนุฑูู ุงููุฑูุถ (12 ุญุฑู)
  Tumor_Sample_Barcode = as.character(maf_file@data$Tumor_Sample_Barcode),  # ุงููุนุฑูู ุงููุงูู ููุนููุฉ
  stringsAsFactors = FALSE
)

#ุฅุฒุงูุฉ ุงูุชูุฑุงุฑ ุนูู ูุณุชูู ุงููุฑูุถ 
id_map <- id_map[!duplicated(id_map$short_id), ]


matched_clinical_data <- merge(
  x = Breast_tumor_metadata,     # ุงูุจูุงูุงุช ุงูุณุฑูุฑูุฉ
  y = id_map,                    # ุฎุฑูุทุฉ ุงููุนุฑููุงุช ูู ููู ุงูู MAF
  by.x = "bcr_patient_barcode",  # ุงุณู ุนููุฏ ุงููุฑูุถ ูู ุงูุจูุงูุงุช ุงูุณุฑูุฑูุฉ
  by.y = "short_id",             # ุงุณู ุนููุฏ ุงููุฑูุถ (12 ุญุฑู) ูู ุงูุฎุฑูุทุฉ
  all.x = FALSE                  # ุงุญุชูุธ ููุท ุจุงููุฑุถู ุงูููุฌูุฏูู ูู ุงูู MAF
)


## ุงูุขู: matched_clinical_data ูุญูู ููุท ุงููุฑุถู ุงููุทุงุจูููุ ูุจุฏุงุฎูู ุนููุฏ Tumor_Sample_Barcode ุงููุดุชุฑู.


```

<br><br>

**โ ูุณุชุทูุน ุงูุขู ุฅูุดุงุก ููู MAF ููุชููุ ูุญุชูู ุนูู ุงูุจูุงูุงุช ุงููุตููุฉ ุงูุฅูููููููุฉ:**

<br><br>

```{r integrate maf and metadata file}

maf_file <- read.maf(maf = url2, clinicalData = matched_clinical_data, verbose = F)

```


___

## 5. ููุทูู ุงูุขู ูุงุณุชูุดุงู ุงูุทูุฑุงุช ุงูุฌูููุฉ ุงูููุณุฌูุฉ ูู ููู MAF!

<br><br>

### 5.1 ููุฎุต ุงูุทูุฑุงุช ุงูููุณุฌูุฉ ูู ููู MAF ููู ูุฑูุถ.๐ฉบ

```{r get sample summary}

getSampleSummary(maf_file)

```

<br><br>

### 5.2 ููุฎุต ุงูุทูุฑุงุช ุงูููุณุฌูุฉ ูู ููู MAF ููู ุฌูู.๐งฌ

```{r get gene summary}

getGeneSummary(maf_file)

```

<br><br>

### 5.3 ุฑุณู ููุฎุต ุดุงูู ููุนุธู ุงูุจูุงูุงุช 

```{r plot maf summary}
# ุฑุณู ููุฎุต ุดุงูู: ุนุฏุฏ ุงูุทูุฑุงุชุ ูุณุจ ุงูุฃููุงุน ุงููุฎุชููุฉุ ุฅุญุตุงุฆูุงุช ุนุงูุฉ

plotmafSummary(maf = maf_file, rmOutlier = TRUE, addStat = 'median', dashboard = TRUE, titvRaw = FALSE)

```

<br><br>

### 5.4 ุฑุณู Oncoplot ูุฃูุซุฑ 10 ุฌููุงุช ุชุนุฑุถุงู ููุทูุฑุงุช

ุชุนุจุฑ ุฑุณูุฉ ุงูู **oncoplot** ูุงุญุฏุฉ ูู ุฃุดูุฑ ุงูุฑุณููุงุช ุงููุฑุชุจุทุฉ ุจุฏุฑุงุณุฉ ุงูุทูุฑุงุช
ุณุงุนุฏ ุงูุจุงุญุซ ุนูู ุฑุคูุฉ ุงูุฃููุงุท ุงูุฌูููุฉ (mutation patterns) ูุชุญุฏูุฏ ุงูุฌููุงุช ุงูุญุฑุฌุฉ ูู ุชุทูุฑ ุงูุณุฑุทุงู.

```{r plot oncoplot of top 10 genes}

# oncoplot ูุนุฑุถ ุงูุฌููุงุช ุงูุฃุนูู ุชูุฑุงุฑุงู ูู ุนููุงุช ุงููุฑุถู

oncoplot(maf = maf_file, top = 10)

```
<br><br>

### 5.5 ๐ ุชุญููู Transition / Transversion (Ti/Tv)

**๐น Transition (Ti):**
ูู ุงุณุชุจุฏุงู ุจูุฑูููุฏูู โ ุจูุฑูููุฏูู (CโT) ุฃู ุจููุฑูู โ ุจููุฑูู (AโG).

โ ููุน "ูุญุงูุธ" ุฃูุซุฑ (conservative)ุ ููุญุฏุซ ุจุดูู ุดุงุฆุน.

**๐น Transversion (Tv):**
ูู ุงุณุชุจุฏุงู ุจูุฑูููุฏูู โ ุจููุฑูู (CโA, CโG, TโA, TโG).

โ ุฃูู ุดููุนูุงุ ููููุง ูุฏ ุชููู ูุคุซุฑุฉ ุฃูุซุฑ ุนูู ุงูุจุฑูุชูู.

โ๏ธ ุงููุณุจุฉ Ti/Tv ุชูุณุชุฎุฏู ููููุงุณ ูู ุฏุฑุงุณุงุช ุงูุทูุฑุงุชุ ูุบุงูุจูุง ุชููู โ 2โ3 ูู ูุนุธู ุงูุฃูุฑุงู ูุงูู exomes (ูุฃู Ti ุชุญุฏุซ ุฃูุซุฑ).

**๐น ุงููุงุฆุฏุฉ ูู ุชุญููู Ti/Tv:**

ุชูููู ุฌูุฏุฉ ุจูุงูุงุช ุงูุชุณูุณู (NGS):
ูุณุจุฉ Ti/Tv ุงูููุทููุฉ ุชุฏู ุฃู ุงูุจูุงูุงุช ุณูููุฉ ูุบูุฑ ูููุซุฉ ุจุฃุฎุทุงุก ุชุณูุณู.

ุชุญุฏูุฏ ุงูุจุตูุงุช ุงูุทูุฑูุฉ (Mutational Signatures):
ุจุนุถ ุงูุณุฑุทุงูุงุช ุฃู ุนูุงูู ุงูุจูุฆุฉ (ุชุฏุฎููุ ุฃุดุนุฉ UVุ ุฅูุฎ) ุชูุธูุฑ ุฃููุงุท Ti/Tv ูุฎุชููุฉ.

ููู ุงูุขููุงุช ุงูุจููููุฌูุฉ ููุทูุฑุงุช:
ูุซููุง:

โช๏ธ UV โ ูุณุจุจ C>T transitions.

โช๏ธ ุงูุชุฏุฎูู โ ูุฒูุฏ C>A transversions.


```{r plot titv summary }

# ุญุณุงุจ ุฃููุงุน ุงูุงุณุชุจุฏุงู (Ti/Tv) ูู ุงูุทูุฑุงุช

 laml.titv = titv(maf = maf_file, plot = FALSE, useSyn = TRUE)

 # ุฑุณู ููุฎุต Ti/Tv
plotTiTv(res = laml.titv)

```

โ ุงูุฎูุงุตุฉ:
ุงูุชุญููู ููุถุญ ุฃู ุงูู C>T transition ูู ุงูุฃูุซุฑ ุดููุนูุงุ ูุฃู ุงููุณุจุฉ ุงูุฅุฌูุงููุฉ ููุทูุฑุงุช ุชููู ูุตุงูุญ ุงูู Transitions (Ti) ููุงุฑูุฉู ุจุงูู Transversions (Tv)ุ ููู ููุท ูุชููุน ููุฏุนู ุฃู ุงูุจูุงูุงุช ุฐุงุช ุฌูุฏุฉ ุนุงููุฉ.

<br><br>


### 5.6 ุฑุณู ุชูุฒูุน ุงูุฃูููุงุช: Variant Allele Frequency (VAF)

**๐น ูุง ูู ุงูู VAFุ**

VAF = ูุณุจุฉ ุงููุฑุงุกุงุช (Reads) ุงูุชู ุชุญูู ุงูุทูุฑุฉ รท ุฅุฌูุงูู ุงููุฑุงุกุงุช ุงููุบุทูุฉ ููุฐุง ุงูููุถุน.
ูุซุงู: ูู ุนูุฏูุง 100 ูุฑุงุกุฉ ุนูู ูููุน ุฌูููุ ู40 ูููุง ูููุง ุทูุฑุฉ โ VAF = 0.4 (40%).

ููุณุชุฎุฏู ููููุงุณ ูุงุญุชูุงููุฉ ุฃู ุชููู ุงูุทูุฑุฉ:

ุทูุฑุฉ ุฌุณุฏูุฉ (somatic mutation).

ุทูุฑุฉ ูู ุงูุณูุงูุฉ ุงูุชูุงุณููุฉ  (germline mutation).

ุฃู ูุงุชุฌุฉ ุนู heterogeneity (ุงุฎุชูุงุท ุฎูุงูุง ูุฎุชููุฉ ุฏุงุฎู ุงููุฑู).

**๐น ูุงุฐุง ูุณุชูุชุฌ ูู ูุฐุง ุงูููุน ูู ุงูุชุญูููุ**

ุงูุทูุฑุงุช ุฐุงุช VAF ูุฑุชูุน (~0.5 ุฃู ุฃุนูู):

ูุฏ ุชููู ุทูุฑุฉ ูุคุณููุณุฉ (founder mutation) ูู ุงููุฑู.

ุฃู ุฃุญูุงููุง ุทูุฑุฉ germline (ููุฑูุซุฉ).

ุงูุทูุฑุงุช ุฐุงุช VAF ููุฎูุถ (<0.3 ุชูุฑูุจูุง):

ุบุงูุจูุง subclonal mutations โ ููุฌูุฏุฉ ูู ูุณุจุฉ ูู ุงูุฎูุงูุง ุงููุฑููุฉ ููุท.

ุชุนูุณ ุชุบุงูุฑูุฉ ุงููุฑู (tumor heterogeneity).

ุชูุฒูุน VAF ูุฎุชูู ุจูู ุงูุฌููุงุช:

ูุซููุง: TP53 ุบุงูุจูุง ูุธูุฑ ุจุทูุฑุงุช ุนุงููุฉ ุงูุชูุฑุงุฑ ูVAF ูุชูุณุทโุนุงููุ ููุง ูุฏู ุนูู ุฃูู ุฌูู ุฃุณุงุณู ูู ูุดุฃุฉ ุงููุฑู (driver gene).

ุจูููุง ุฌููุงุช ูุซู TTN, MUC16 ุบุงูุจูุง ุชูุธูุฑ VAF ุฃูุซุฑ ุชููุนูุง ูุฃููุง ุฌููุงุช ูุจูุฑุฉ ุงูุญุฌู ูุชุฑุงูู ูููุง ุงูุทูุฑุงุช (passenger mutations).


```{r Variant Allele Frequencies}

plotVaf(maf = maf_file, vafCol = NULL, top = 20)


```


<br><br>

### 5.7 โ๏ธ ุชุญููู ุงูุนูุงูุฉ ุจูู ุงูุฌููุงุชุ ูู ุชุญุฏุซ ุงูุทูุฑุชูู ูุนุงุ

ูุญุงูู ููู ุนูุงูุฉ ุงูุทูุฑุงุช ุจุจุนุถูุงุ ูู ูู ุทูุฑุงุช ุชุนุงูููุฉ (ุชุธูุฑ ุนุงุฏุฉ ูุนุง)ุ ุฃู ุจุฏููุฉ (ูุงุญุฏ ูููุง ูููู ูุฎูู ุงูุฃุซุฑ.)

ููุฐุง ูุณุงุนุฏ ุนูู ููู ุงููุณุงุฑุงุช ุงูุฌุฒูุฆูุฉ ูู ุงูุณุฑุทุงู ูุฑุจูุง ุงูุชุฑุงุญ ุฃูุฏุงู ุนูุงุฌูุฉ (ุฅุฐุง ูุงู ูุณุงุฑ ูุญุฏุฏ ูู ุงููุณูุทุฑ).

```{r somatic Interactions}
# ููุดู ุนู ุนูุงูุฉ ุงูุชุนุงูุด ุฃู ุงูุชูุงูู ุจูู ุงูุทูุฑุงุช ูู ุงูุฌููุงุช

somaticInteractions(maf = maf_file, top = 25, pvalue = c(0.05, 0.1))

```


**๐น ูุงุฐุง ูุณุชูุชุฌ ูู ุงูุดููุ**

TP53 โ PIK3CA:
ุงูุนูุงูุฉ ุจููุฉ (mutually exclusive) โ ุนุงุฏุฉู ูุง ูุชุญูุฑุงู ูุนูุงุ ูุฏ ูุดูุฑ ุฃู ูู ููููุง ูููู ูุฏูุน ุงููุฑู.

PIK3CA โ GATA3 / MAP3K1:
ุงูุนูุงูุฉ ููุฌุจุฉ (co-occurrence) โ ุงูุทูุฑุงุช ุชููู ููุธููุฑ ูุนูุง.

ูุนุธู ุงูุฌููุงุช ุงูุฃุฎุฑู (MUC16, TTN, SYNE1, FLGโฆ ุฅูุฎ):
ุชุธูุฑ ุงุฑุชุจุงุทุงุช ููุฌุจุฉ ูููุฉ ุฌุฏูุง (* ุฃุฎุถุฑ ุฏุงูู)ุ ููุง ูุฏ ูุนูุณ ููููุง "Passenger mutations" ูุชุฌูุนุฉ.

ุชูุณูุฑ ุจููููุฌู:

Co-occurrence: ููุญู ุจุฃู ุงูุฌููุงุช ุชุนูู ูู ูุณุงุฑุงุช ูุฎุชููุฉ ููู ุชูุงูููุฉุ ูุงููุฑู ูุณุชููุฏ ูู ุชุญููุฑููุง ูุนูุง.

Mutual exclusivity: ููุญู ุจุฃู ุงูุฌููุงุช ุชุนูู ูู ููุณ ุงููุณุงุฑ (pathway redundancy)ุ ูุทูุฑุงุช ุฃุญุฏููุง ุชููู ูุชุนุทูู ุงููุณุงุฑ.


<br><br>

## 6. ุชุญููู ุชุฃุซูุฑ ุงูุทูุฑุงุช ุนูู ุงูุญูุงุฉ (ูู ุชุคุซุฑ ุงูุทูุฑุงุช ูู ูุฐุง ุงูุฌูู ุนูู ูุฏุฉ ุงูุนูุดุ)
<br><br>

ูุฅุฌุฑุงุก ูุฐุง ุงูุชุญููู ูุญุชุงุฌ ูุนูููุชูู ุฑุฆูุณูุชูู:
1) ุญุงูุฉ ุงููุฑูุถ: ุญู ุฃู ูุชููู. ููุฌุจ ูุชุงุจุชูุง ุจุทุฑููุฉ 0 ุฃู 1ุ ุญูุซ ุฃู 0 ุชุฑูุฒ ููุญูุงุฉ ู 1 ุชุฑูุฒ ููููุงุฉ.
2) ูุฌุจ ุฃู ูููู ูุฏููุง ุนุฏุฏ ุงูุฃูุงู ุญุชู ุขุฎุฑ ุฒูุงุฑุฉ ูููุฑูุถ ุฃู ุญุชู ููุช ุงูููุงุฉ.


### 6.1 ูุชุฃูุฏ ุจุฃู ุงูุจูุงูุงุช ุชุณุชููู ุงูุดูู ุงููุทููุจ ูุชุทุจูู ุงูุชุญููู

```{r data engineering - survival analysis}

# 1) ุชุญููู ุญุงูุฉ ุงูููุงุฉ ุฅูู 0/1
maf_file@clinical.data$vital_status <- ifelse(maf_file@clinical.data$vital_status %in% c("Dead", "1"), 1, 0)

# 2) ุชุญููู ุงูุฃูุงู ุฅูู ููู ุฑูููุฉ
num <- function(x) suppressWarnings(as.numeric(as.character(x)))
dtd  <- num(maf_file@clinical.data$days_to_death)
dtlf <- num(maf_file@clinical.data$days_to_last_followup)

# 3) ุญุณุงุจ ุฒูู ุงูุจูุงุก (OS.time): ููุช ุงูููุงุฉ ุฃู ุขุฎุฑ ูุชุงุจุนุฉ

maf_file@clinical.data$OS.time <- ifelse(!is.na(dtd), dtd, dtlf)

# ุชุฃููุฏ ุฃู ุงูููู ุฑูููุฉ

maf_file@clinical.data[,vital_status :=  as.numeric(vital_status)]
maf_file@clinical.data[,OS.time :=  as.numeric(OS.time)]


```

<br><br>

### 6.2 ๐งฌูููู ุจุชุญููู ุชุฃุซูุฑ ุงูุทูุฑุงุช ุนูู ุงูุญูุงุฉ ูู ุฌูู ูุงุญุฏ ููุท

```{r Survival analysis}

# 4) ุชุญููู ุงูุจูุงุก ูุฌูู ูุญุฏุฏ (ูุซุงู: NEB)

mafSurvival(maf = maf_file, genes = 'NEB', time = 'OS.time', Status = 'vital_status', isTCGA = FALSE)


```

<br><br>

### 6.3 ๐งฌ ุชุญููู ุชุฃุซูุฑ ุงูุทูุฑุงุช ุนูู ุงูุญูุงุฉ ุจุงุณุชุฎุฏุงู ูุฌููุนุงุช ูู ุงูุฌููุงุช

ุฑุจูุง ูุง ูููู ูุฌูู ูุงุญุฏ ุชุฃุซูุฑ ูุจูุฑุ ูููู ูู ุจุนุถ ุงูุญุงูุง ูุฌูุฏ ุทูุฑุชูู ูู ุฌูููู ูุฎุชูููู ูู ููุช ูุงุญุฏ ูุณุจุจ ุฅูุง ููุงุฉ ุฃุณุฑุน ุฃู ูุณุงุนุฏ ุนูู ุงูุนูุด ููุชุฑุฉ ุฃุทููุ ููุงูุชุดุงู ุฐูู ูููู ุจุฅุฌุฑุงุก ูุฐุง ุงูุชุญููู.


```{r survival analysis - gene sets}

# 5) ุชุญููู ุงูุจูุงุก ูุฃูุซุฑ ูู ุฌูู

# ุงูุจุญุซ ุนู ูุฌููุนุงุช ุฌููุงุช (ูุซูุงู 2 ุฌูู) ูู ุจูู ุฃุนูู 100 ุฌูู ูุชููุน ุงูุจูุงุก

prog_geneset = survGroup(maf = maf_file, top = 100, geneSetSize = 2, time = "OS.time", Status = "vital_status", verbose = TRUE)

 #ุนุฑุถ ุฃูู 5 ุตููู ูู ุงููุชูุฌุฉ
head(prog_geneset, 5)

```

<br><br>

### 6.4 ๐ชข ุฑุณู ูุชุงุฆุฌ ุงูุชุญููู ููุฌููุนุฉ ูู ุงูุฌููุงุช


```{r plot survaival analysis of two genes}

# ูุซุงู: ุชุญููู ุงูุจูุงุก ูุฌููู MUC17 ู BRCA2

mafSurvGroup(maf = maf_file, geneSet = c("MUC17", "BRCA2"), time = "OS.time", Status = "vital_status")


```

<br><br>

___

## 7. ุฑุจุท ุงูุทูุฑุงุช ุงูุฌูููุฉ ุจุงูุจูุงูุงุช ุงูุณุฑูุฑูุฉ

### 7.1 ๐ฉโโ๏ธ ูู ุชูุฌุฏ ุฌููุงุช ุชุชุฑุงูู ุทูุฑุงุชูุง ูุน ุฌูุณ ุงููุฑูุถุ

#### 7.1.1 ๐ ูุชุฃูุฏ ูู ุฃู ุงูุจูุงูุงุช ููุงุณุจุฉ ูุฅุฌุฑุงุก ุงูุชุญููู ุงูุฅุญุตุงุฆู.

```{r Clinical enrichment analysis - gender}

# ุชูุฒูุน ุงูุนููุงุช ุญุณุจ ุงูุฌูุณ

table_gender <- table(maf_file@clinical.data$gender) 

barplot(table_gender,
        main = "Gender distribution of breast tumor cases",
        ylab = "Count",
        col = c("pink", "lightblue"))

```

ูุณุชูุชุฌ ุฃู ุงูููุงุฑูุฉ ููุง ูู ุชูุฌุญ ุฅุญุตุงุฆูุง ุจุณุจุจ ุงูุงุฎุชูุงู ุงููุจูุฑ ุจุนุฏุฏ ุงูุนููุงุช ุจูู ุงูุฐููุฑ ูุงูุฅูุงุซ.

<br><br>

___

### 7.2 โข๏ธ ูู ุชูุฌุฏ ุฌููุงุช ุชุชุฑุงูู ุทูุฑุงุชูุง ูุน ุญุงูุฉ ุงูุนูุงุฌ ุงูุฅุดุนุงุนู ูููุฑูุถุ

#### 7.2.1 ูุชุฃูุฏ ูู ุฃู ุงูุจูุงูุงุช ููุงุณุจุฉ ูุฅุฌุฑุงุก ุงูุชุญููู ุงูุฅุญุตุงุฆู.


```{r Check radiation therapy}

# ููุฎุต ุญุงูุฉ ุงูุนูุงุฌ ุงูุฅุดุนุงุนู ูู ุงูุจูุงูุงุช ุงูุณุฑูุฑูุฉ

table_radiation <- table(maf_file@clinical.data$radiation_therapy)

#ุฑุณู ุชูุฒูุน ุงูุญุงูุงุช

barplot(table_radiation,
        main = "Radiation therapy status",
        ylab = "Count",
        col = c("orange", "gray70", "gray90", "lightblue", "tomato"),
        las = 2)  # rotate labels for readability

```

#### 7.2.2 ูุญุชุงุฌ ูุฅุฒุงูุฉ ุงูุจูุงูุงุช ุงูุบูุฑ ููุณุฌูุฉ ุฃู ุงูููููุฏุฉ.

``` {r engineer radiation therapy data}

# ุชูุญูุฏ ุงูููู ุฅูู YES/NO ููุทุ ููุง ุนุฏุง ุฐูู ูุญููู ุฅูู NA
maf_file@clinical.data$radiation_therapy <- ifelse(
  maf_file@clinical.data$radiation_therapy %in% c("NO", "YES"),
  maf_file@clinical.data$radiation_therapy,
  NA
)

# ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุฌุฏูู ุจุนุฏ ุงูุชูุธูู
table_radiation <- table(maf_file@clinical.data$radiation_therapy)

# ุฑุณู ุงูุชูุฒูุน ุจุนุฏ ุงูุชูุธูู (YES/NO ููุท)
barplot(table_radiation,
        main = "Radiation therapy status",
        ylab = "Count",
        col = c( "lightblue", "tomato"),
        las = 2)  # rotate labels for readability

```

#### 7.2.3 ๐ ูููู ุงูุขู ุจุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑ ุงูุฅุญุตุงุฆู.

```{r Clinical enrichment analysis - radiation_therapy}

#Clinical feature enrichment using maftools

radiation_therapy.ce = clinicalEnrichment(maf = maf_file, clinicalFeature = 'radiation_therapy')

head(radiation_therapy.ce)

# ุฅุจุฑุงุฒ ุงูููุงุฑูุงุช ุฐุงุช ุงูุฏูุงูุฉ ุงูุฅุญุตุงุฆูุฉ (p < 0.05)
radiation_therapy.ce$pairwise_comparision[fdr < 0.05]



```

<br><br>

#### 7.2.4 ๐ ุงุณุชุฎุฑุงุฌ ุงูุฌููุงุช ุงููุฑุชุจุท ุจุงูุนูุงุฌ ุงูุงุดุนุงุนู ุจุทุฑููุฉ ุฃูุซุฑ ุตุญุฉ ุฅุญุตุงุฆูุง

```{r plot sig genes}

#Extract pairwise comparisons table
df <- radiation_therapy.ce$pairwise_comparision

# extract numerator/denominator and compute relative frequencies

df[, c("mut1", "total1") := tstrsplit(n_mutated_Feature1, " of ", fixed=TRUE)]
df[, c("mut2", "total2") := tstrsplit(n_mutated_Feature2, " of ", fixed=TRUE)]

# Convert to numeric
df[, `:=`(mut1 = as.numeric(mut1),
          total1 = as.numeric(total1),
          mut2 = as.numeric(mut2),
          total2 = as.numeric(total2))]

# Compute relative values
df[, rel1 := mut1 / total1]
df[, rel2 := mut2 / total2]

df <- df[order(-rel1, -rel2)]
df <- df[fdr < 0.01]

# Take top 10 significant genes
top10 <- df[order(fdr)][1:10]


# Reshape to long format for ggplot
plotdf <- melt(top10,
               id.vars = "Hugo_Symbol",
               measure.vars = c("rel1", "rel2"),
               variable.name = "Feature",
               value.name = "Relative")

# Make Feature labels clearer
plotdf[, Feature := fifelse(Feature == "rel1", "Feature_1 (YES)", "Feature_2 (NO)")]

# Plot
ggplot(plotdf, aes(x = reorder(Hugo_Symbol, Relative), y = Relative, fill = Feature)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  coord_flip() +
  labs(x = "Gene", y = "Relative mutated fraction",
       title = "Top 10 significant genes by relative mutation frequency") +
  theme_minimal()


```

<br><br>

#### 7.2.5 ๐ฏ Effect Size vs Significance


```{r plot }
# ูุฑู ุงููุณุจุฉ ุจูู ุงููุฌููุนุชูู ูุญุฌู ุชุฃุซูุฑ ูุจุณูุท


top10[, diff_rel := rel1 - rel2]

ggplot(top10, aes(x = diff_rel, y = -log10(fdr), label = Hugo_Symbol)) +
  geom_point() +
  geom_text_repel() +
  theme_minimal() +
  labs(x = "Difference in relative mutation (Feature1 - Feature2)",
       y = "-log10(FDR)",
       title = "Effect size vs significance")
```

<br><br>

___

## 8. ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช ุงูุฌูููุฉ ูุงูุฏูุงุฆูุฉ

### 8.1 ๐ ุงูุจุญุซ ุนู ุงูุฃุฏููุฉ ุงูููุงุณุจุฉ ููู ุฌูู ูู ููู MAF

```{r drug-gene interactions}
# ุงูุจุญุซ ุนู ุชูุงุนูุงุช ุฏูุงุก-ุฌูู ูููุญุฉ ุงูุฌููุงุช ุงููุณุชุฎูุตุฉ ูู ุงูู MAF
dgi = drugInteractions(maf = maf_file, fontSize = 0.75)

```


### 8.2 ูุงุฐุง ุนู ุงูุฃุฏููุฉ ุงูููุณุฌูุฉ ูุฌูู ูุงุญุฏ ููุทุ


```{r DGI - specific gene}

# ุงุณุชุฑุฌุงุน ุงูุชูุงุนูุงุช ุงูุฏูุงุฆูุฉ ูุฌูู ูุญุฏุฏ
dnmt3a.dgi = drugInteractions(genes = "TP53", drugs = TRUE)

# ุนุฑุถ ุฃุนูุฏุฉ ูุฎุชุงุฑุฉ ูููุฏุฉ ููุชูุงุฑูุฑ
dnmt3a.dgi[,.(Gene, interaction_types, drug_name, drug_claim_name)]

```

<br><br>

___

## 9. ุงุณุชุฎุฑุงุฌ ูุณุงุฑุงุช ุฃูุถูุฉ ููุชุฃุซุฑุฉ ุจุงูุทูุฑุงุช


```{r Oncogenic Signaling Pathways}

pws = pathways(maf = maf_file, plotType = 'bar')

pws

```

<br><br>

___


## 10. ๐งฉ  ุฏุฑุงุณุฉ ุชููุน ุงูุทูุฑุงุช ุฏุงุฎู ุงูุฃูุฑุงู

**๐น ูุง ุงูููุฑุฉุ**

ุงูุฃูุฑุงู ููุณุช ูุชูุฉ ุฎูููุฉ ูุชุฌุงูุณุฉุ ุจู ุบุงูุจูุง ุชุชููู ูู ุนุฏุฉ ูุณุชุนูุฑุงุช (clones) ูู ุงูุฎูุงูุงุ ูู ูุณุชุนูุฑุฉ ุชุญูู ูุฌููุนุฉ ูู ุงูุทูุฑุงุช ุงููููุฒุฉ.

ุงูุทูุฑุงุช ุงูุชู ุชุญุฏุซ ูู ุจุฏุงูุฉ ูุดุฃุฉ ุงููุฑู (founder mutations) ุชุธูุฑ ุจูุณุจุฉ ุนุงููุฉ (VAF ูุฑุชูุน).

ุงูุทูุฑุงุช ุงูุชู ุชุญุฏุซ ูุงุญููุง ุฃุซูุงุก ุชุทูุฑ ุงููุฑู ุชุธูุฑ ูู subclones (VAF ุฃูู).

๐ ูุฐููุ ุชูุฒูุน VAF ูููู ุชูุณููู ุฅูู clusters โ ูู cluster ููุซู ูุฌููุนุฉ ูู ุงูุทูุฑุงุช ุงููุฑุชุจุทุฉ ุจูุณุชุนูุฑุฉ ูุนููุฉ.





```{r Tumor heterogeneity and MATH scores}

# mclust ูุทููุจุฉ ูุชุฌููุน ุงูุชูุฒูุนุงุช (Gaussian mixture models)
library("mclust")

```

ูุฎุงุฑ ุนููุฉ ูุงุญุฏุฉ ููุท ููุฏุฑุณ ููู ุชุชููุน ุงูุทูุฑุงุช ูู ูุฐู ุงูุนููุฉ

```{r tumor}

hetero_breast_tumor = inferHeterogeneity(maf = maf_file, tsb = 'TCGA-3C-AAAU-01A-11D-A41F-09')

print(hetero_breast_tumor$clusterMeans)

#Visualizing results
plotClusters(clusters = hetero_breast_tumor)


```

**๐น ุงูุงุณุชูุชุงุฌ:**

ุงููุฑู ูู ูุฐู ุงูุนููุฉ ูุชุบุงูุฑ ุจุดุฏุฉ (MATH ~47).

ููุงู ุนูู ุงูุฃูู 3 ูุฌููุนุงุช/ูุณุชุนูุฑุงุช ูุฎุชููุฉ ูู ุงูุฎูุงูุง:

ุทูุฑุงุช subclonal (VAF ููุฎูุถ).

ุทูุฑุงุช clonal ุซุงูููุฉ (VAF ูุชูุณุท).

ุทูุฑุงุช ูุคุณููุณุฉ ุฃู ุฌูุฑูููู (VAF ุนุงูู).

**๐ฌ ูุฐุง ููู ูุฃูู:**

ูุนูุณ ุชุทูุฑ ุงููุฑู (tumor evolution).

ููุณุฑ ููุงุฐุง ุจุนุถ ุงูุฃูุฑุงู ููุงููุฉ ููุนูุงุฌ (ูุฃู ูุณุชุนูุฑุงุช ูุฑุนูุฉ ูุฏ ุชูุฌู).

ูุณุงุนุฏ ูู ุชุญุฏูุฏ ุงูุนูุงุฌุงุช ุงููุณุชูุฏูุฉ ุจูุงุกู ุนูู ุงูุทูุฑุงุช ุงููุดุชุฑูุฉ ุจูู ุฌููุน ุงูุฎูุงูุง ุงููุฑููุฉ (clonal mutations).


___
<br><br>

## 11. Mutation Signature 

ูู ูุฑู ูุชุฑู ุฎููู ุจุตูุฉ (Signature) ุฎุงุตุฉ ุจูุ ุนุจุงุฑุฉ ุนู ููุท ูููุฒ ูู ุงูุทูุฑุงุช (substitution types).
ูุฐู ุงูุจุตูุงุช ูุฑุชุจุทุฉ ุบุงูุจูุง ุจุขููุงุช ุจููููุฌูุฉ ูุญุฏุฏุฉ (ูุซู: APOBEC, UV, ุงูุชุฏุฎูู, MMR deficiency โฆ ุฅูุฎ).
๐ ุงูุชุญููู ูุชู ุนุจุฑ:

ุจูุงุก ูุตูููุฉ ุงูุทูุฑุงุช (trinucleotide mutation matrix).

ุงุณุชุฎุฏุงู NMF (non-negative matrix factorization) ูุงุณุชุฎุฑุงุฌ ุนุฏุฏ n ูู ุงูุจุตูุงุช.

ููุงุฑูุฉ ุงูุจุตูุงุช ุงููุณุชุฎุฑุฌุฉ ูุน ูุงุนุฏุฉ ุจูุงูุงุช COSMIC Signatures ููุนุฑูุฉ ุงูุณุจุจ ุงููุญุชูู ููุทูุฑุงุช.

ูุณุงุนุฏูุง ูู ุนูู ุฐูู ุญุฒูุฉ NMF ูุงูุชู ุณุชููู ุจุญุณุงุจ ุนุฏุฏ ุงูุจุตูุงุช ุงููุชููุนุฉ.


```{r signature}

library('NMF')
library("BSgenome.Hsapiens.UCSC.hg19", quietly = TRUE)
```

<br><br>


### 11.1 Trinucleotides 

**๐นูุง ูุนูู Trinucleotides analysisุ**

ุนูุฏูุง ูุญูู ุงูุทูุฑุงุชุ ูุง ูููู ููุท ุฃู ูุนุฑู ุฃู ุงูุทูุฑุฉ ูุซููุง C>Tุ ูุฃู ุณูุงู ุงููุงุนุฏุฉ ูุจููุง ูุจุนุฏูุง (ยฑ1 base) ููู ุฌุฏูุง.

ูุซุงู: ุงูุทูุฑุฉ C>T ูุฏ ุชุญุฏุซ ูู ุชุณูุณู TCA โ TTA ุฃู ูู GCG โ GTG.

ูุฐู ุงูุณูุงูุงุช ุงูุซูุงุซูุฉ (trinucleotides) ุชุณุงุนุฏูุง ุนูู ุชุญุฏูุฏ ุจุตูุฉ ุงูุทูุฑุฉ (Mutational signature).

ุฏุงูุฉ trinucleotideMatrix() ูู maftools:

ุชูุดุฆ ูุตูููุฉ ุชุตููู ุงูุทูุฑุงุช ุฅูู 96 ููุนูุง ูุฎุชูููุง (6 ุฃููุงุน ุจุฏุงุฆู ุฃุณุงุณูุฉ ร 16 ุณูุงู ุซูุงุซู).

```{r Trinucleotides analysis}



laml.tnm = trinucleotideMatrix(maf = maf_file, prefix = 'chr', add = TRUE, ref_genome = "BSgenome.Hsapiens.UCSC.hg19")

plotApobecDiff(tnm = laml.tnm, maf = maf_file, pVal = 0.2)

```

<br><br>

**๐นูุง ูู APOBECุ**

APOBEC = ุงุฎุชุตุงุฑ ูู Apolipoprotein B mRNA Editing Catalytic Polypeptide-like.

ูู ุนุงุฆูุฉ ูู ุงูุฅูุฒููุงุช ูู ุงูุฌุณู ูุธููุชูุง ุงูุทุจูุนูุฉ: ููุงูุญุฉ ุงูููุฑูุณุงุช ุนุจุฑ ุฅุฏุฎุงู ุทูุฑุงุช ูู DNA ุงูููุฑูุณ.

ููู ุฃุญูุงููุงุ ูุฐู ุงูุฅูุฒููุงุช ุชุฎุทุฆ ูุชุจุฏุฃ ุจุฅุญุฏุงุซ ุทูุฑุงุช ูู DNA ุงูุฎูุงูุง ุงูุจุดุฑูุฉ ููุณูุง.

โด๏ธ ุงูููุท ุงููููุฒ ูุทูุฑุงุช APOBEC:

ุบุงูุจูุง ุชููู C>T ุฃู C>G.

ูุชุญุฏุซ ูู ุณูุงู tCw (ุฃู C ูู ูุณุท ุซูุงุซูุฉ TCA ุฃู TCT).


**๐นูุง ุงููุฏู ูู ุชุญููู APOBEC ูู ุงูุณุฑุทุงูุ**

ุชุญุฏูุฏ ุฅุฐุง ูุงู ุงููุฑู ุบูู ุจู APOBEC activity (APOBEC-enriched):

ูุนูู ุฃู ุฌุฒุกูุง ูุจูุฑูุง ูู ุทูุฑุงุชู ูุงุชุฌ ุนู ูุดุงุท ูุฐู ุงูุฅูุฒููุงุช.

ููุงุฑูุฉ APOBEC vs non-APOBEC samples (plotApobecDiff):

ูุนุฑู ูู ููุงู ูุฑู ูู ุนุจุก ุงูุทูุฑุงุช (mutation load).

ูุนุฑู ุฃู ุฌููุงุช ุชุชุฃุซุฑ ุฃูุซุฑ ูู ุงูุนููุงุช ุงูุบููุฉ ุจู APOBEC (ูุซู PIK3CA).

ุชูุณูุฑ ุงูุจุตูุฉ ุงูุฌูููุฉ:

ุฅุฐุง ูุฌุฏูุง ุฃู ูุนุธู ุงูุทูุฑุงุช ูู ููุน APOBEC โ ูุณุชูุชุฌ ุฃู ูุฐุง ุงูุฅูุฒูู ุณุงูู ูู ุชุทูุฑ ุงููุฑู.

ุฃูููุฉ ุณุฑูุฑูุฉ:

ุงูุฃูุฑุงู ุฐุงุช ุงูุทูุฑุงุช ุงููุงุชุฌุฉ ุนู APOBEC ุฃุญูุงููุง ุชููู ุฃูุซุฑ ูุชุญููุฉ (hypermutated).

ูุฐุง ูุฏ ูุฌุนููุง ุฃูุซุฑ ุงุณุชุฌุงุจุฉ ูุนูุงุฌุงุช ููุงุนูุฉ ูุซู Immune checkpoint inhibitors.

<br><br>


### 11.2 ๐ข Estimate Optimal Number of Signatures
ูุณุชุฎุฏู NMF ูุชููุน ุงูุนุฏุฏ ุงูููุงุณุจ ูู ุงูุจุตูุงุช.

```{r estimateSignatures}

laml.sign = estimateSignatures(mat = laml.tnm, nTry = 6)

plotCophenetic(res = laml.sign)

```

<br><br>

### 11.3 โ๏ธ Extract NMF signatures for chosen K
ูููู ุงูุขู ุจุงุณุชุฎุฑุงุฌ ุงูุจุตูุงุช.

```{r extract signature}

NMF::nmf.options("verbose" = 0)
laml.sig = maftools::extractSignatures(mat = laml.tnm, n = 3,  parallel = 1)


```

<br><br>


### 11.4 ๐ Compare against COSMIC reference signatures

**๐น ูุง ูู COSMICุ**

COSMIC ูู ุงุฎุชุตุงุฑ ูู:
Catalogue Of Somatic Mutations In Cancer

๐ ููู ุฃูุจุฑ ูุงุนุฏุฉ ุจูุงูุงุช ุนุงูููุฉ ูุชุฎุตุตุฉ ูู:

ุงูุทูุฑุงุช ุงูุฌุณุฏูุฉ (Somatic mutations) ุงูููุชุดูุฉ ูู ุงูุณุฑุทุงู.

ุฃูุดุฆ ูู ูุนูุฏ ุณุงูุบุฑ (Sanger Institute โ UK).

**๐น ูุญุชูู COSMIC**

ุจูุงูุงุช ูู ุขูุงู ุงูุฃูุฑุงู ุงูุจุดุฑูุฉ.

ูุดูู ุฃููุงุน ูุฎุชููุฉ ูู ุงูุทูุฑุงุช:

Single Nucleotide Variants (SNVs) (ูุซู C>T).

Insertions & Deletions (InDels).

Copy Number Variations (CNVs).

Fusions/Translocations.

ุฃูุถูุง ูุญุชูู ุนูู Mutational Signatures (ุจุตูุงุช ุงูุทูุฑุงุช) ุงูุชู ุทูุฑูุง Alexandrov ูุขุฎุฑูู.


**๐น ุฃูููุฉ COSMIC**

ูุฑุฌุน ุนุงููู:
ุฃู ุทูุฑุฉ ุชููุชุดู ูู ุงูุณุฑุทุงู ูููู ููุงุฑูุชูุง ุจุจูุงูุงุช COSMIC ููุนุฑูุฉ:

ูู ูู ูุนุฑููุฉ ูุณุจููุงุ

ูู ุชุนุชุจุฑ ุทูุฑุฉ "driver" (ูุณุจุจุฉ ููุณุฑุทุงู) ุฃู "passenger" (ุทูุฑุฉ ุนุดูุงุฆูุฉ)ุ

ุชุญููู ุงูุจุตูุงุช ุงูุทูุฑูุฉ:

COSMIC ุตูู ุนุดุฑุงุช ุงูุจุตูุงุช ุงูุทูุฑูุฉ (Mutational Signatures, SBS, DBS, ID signatures).

ูู ุจุตูุฉ ูุฑุชุจุทุฉ ุจุขููุฉ ูุนููุฉ (ูุซู ุงูุชุฏุฎููุ ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉุ APOBECุ ุฎูู ุฅุตูุงุญ DNA โฆ ุฅูุฎ).

ุฃุฏุงุฉ ููุจุญุซ ุงูุนููู ูุงูุณุฑูุฑู:

ูุณุชุฎุฏููุง ุงูุจุงุญุซูู ูุชูุณูุฑ ุจูุงูุงุช NGS.

ุงูุฃุทุจุงุก ูููู ุฃู ูุณุชููุฏูุง ูููุง ูุชุญุฏูุฏ ุงูุฃูุฏุงู ุงูุนูุงุฌูุฉ (Therapeutic targets).




```{r compare signature}

laml.v3.cosm = compareSignatures(nmfRes = laml.sig, sig_db = "SBS")


```

<br><br>

### 11.5 โจ๏ธ Heatmap: cosine similarity to validated signatures

ูููุงุฑู ุจุงูุจุตูุงุช ุงููุฑุงุซูุฉ ุงูุชู ูุฏููุง ุจุงูุจุตูุงุช ุงููุณุฌูุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุช COSMIC
ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงุญุตุงุฆูุฉ ุชุณูู: cosine similarity.

```{r heatmap signature}

library('pheatmap')

pheatmap::pheatmap(mat = laml.v3.cosm$cosine_similarities, cluster_rows = FALSE, main = "cosine similarity against validated signatures")

```

<br><br>

### 11.6  Plot extracted signatures (SBS labels)

ูุฐุง ุงูุฑุณู ูู ุงูุฎุทูุฉ ุงูููุงุฆูุฉ ูู ุชุญููู ุงูู mutational signatures:

ููุถุญ ุฃููุงุท ุงูุทูุฑุงุช (96-contexts).

ูุฑุจุทูุง ุจุฃุดูุฑ ุงูุจุตูุงุช ุงูุนุงูููุฉ (SBS signatures).

ูุณุงุนุฏ ูู ุชูุณูุฑ ุงูุทูุฑุงุช ูู ููุธูุฑ ุจููููุฌู ูุณุฑูุฑู.


```{r plot signature}

maftools::plotSignatures(nmfRes = laml.sig, title_size = 1.2, sig_db = "SBS")

```


**๐น ุดุฑุญ ุงููุชุงุฆุฌ ุงููุนุฑูุถุฉ:**

**๐ Signature 1 โ SBS2**
Cosine similarity: 0.767

Aetiology: ูุดุงุท ุฅูุฒูู APOBEC (Cytidine Deaminase) ุงูุฐู ูุญูู C ุฅูู T (ูุฃุญูุงููุง C ุฅูู G).

ุงูููุท ุงููููุฒ: ุงุฑุชูุงุน ูู ุทูุฑุงุช C>T ูู ุณูุงู TCN (tCw).

ุงูุฃูููุฉ:

ุดุงุฆุน ูู ุณุฑุทุงูุงุช ุงูุซุฏู ูุงูุฑุฆุฉ ูุนูู ุงูุฑุญู.

ูุฑุชุจุท ุจุฒูุงุฏุฉ ุงูุญูู ุงูุทูุฑู (hypermutation).


**๐ Signature 2 โ SBS6**
Cosine similarity: 0.834

Aetiology: ุฎูู ูู DNA mismatch repair (MMR defect).

ุงูููุท ุงููููุฒ: ุงูุชุดุงุฑ ุทูุฑุงุช ูุชููุนุฉ ุฎุงุตุฉ ูู C>T ู C>A.

ุงูุฃูููุฉ:

ููุฌูุฏ ูู ุณุฑุทุงูุงุช ุงูููููู ูุงููุณุชููู (microsatellite instability โ MSI).

ุณุฑูุฑููุง: ุงูุฃูุฑุงู ุฐุงุช MMR-deficiency ุบุงูุจูุง ุชุณุชุฌูุจ ุจุดูู ุฌูุฏ ููุนูุงุฌ ุงูููุงุนู (immune checkpoint inhibitors).


**๐ Signature 3 โ SBS10b**
Cosine similarity: 0.883

Aetiology: ุทูุฑุงุช ูู Polymerase epsilon (POLE) exonuclease domain.

ุงูููุท ุงููููุฒ: ูุณุจุฉ ุนุงููุฉ ุฌุฏูุง ูู C>T (ูุฎุงุตุฉ ูู ุณูุงูุงุช ูุนููุฉ).

ุงูุฃูููุฉ:

ุงูุฃูุฑุงู ุฐุงุช ุทูุฑุงุช POLE ุนุงุฏุฉ ุชููู hypermutated.

ูููู ุฃู ุชููู ุฃูุซุฑ ููุงุนุฉ (high neoantigen load) ูุจุงูุชุงูู ูุฑุดุญุฉ ููุนูุงุฌ ุงูููุงุนู.

๐น ุงูุงุณุชูุชุงุฌ:

ูู ูุฐู ุงูุจูุงูุงุชุ ุชู ุชุญุฏูุฏ 3 ุจุตูุงุช ุฑุฆูุณูุฉ ููุทูุฑุงุช:

APOBEC (SBS2) โ ุฅูุฒูู ูุณุจุจ C>T.

MMR defect (SBS6) โ ุฎูู ุฅุตูุงุญ DNA.

POLE mutations (SBS10b) โ ุนุทุจ ูู ุฅูุฒูู ุงูุจูููููุฑุงุฒ.

โก๏ธ ูุฐู ุงููุชุงุฆุฌ ุชุนูุณ ุฃู ุงููุฑู ุงููุฏุฑูุณ ูุดุฃ ูู ุชุนุฏุฏ ุขููุงุช ุทูุฑูุฉ ูุฎุชููุฉ (enzyme-induced, repair-defect, polymerase-defect).

___
___

#ุฎุชุงูุง

## ๐ฌ ูู ูุฐุง ุงูุชุญููู ุจุงุณุชุฎุฏุงู maftools:

1. ุจุฏุฃูุง ุจู ูุฑุงุกุฉ ุจูุงูุงุช ุงูุทูุฑุงุช (MAF file) ูุงุณุชูุดุงู ุฃูู ุงูุฌููุงุช ุงููุชุฃุซุฑุฉ (oncoplot).

2. ุญูููุง ุฃููุงุท ุงูุทูุฑุงุช ุงูุฃุณุงุณูุฉ (Transition/Transversion, VAF distribution).

3. ุฏุฑุณูุง ุงูุนูุงูุงุช ุจูู ุงูุฌููุงุช ุงููุชุญูุฑุฉ (co-occurrence vs mutual exclusivity).

4. ูููููุง ุชุบุงูุฑูุฉ ุงููุฑู (Tumor heterogeneity) ุจุงุณุชุฎุฏุงู VAF clustering ู MATH score.

5. ุฃุฌุฑููุง ุชุญููู Mutational Signatures:

5.1 ุงุณุชุฎุฑุงุฌ ุงูุจุตูุงุช ุงูุทูุฑูุฉ ุจุงูู NMF.

5.2 ุชุญุฏูุฏ ุงูุนุฏุฏ ุงูุฃูุซู ููุจุตูุงุช (cophenetic metric).

5.3 ููุงุฑูุฉ ุงูุจุตูุงุช ุงููุณุชุฎุฑุฌุฉ ูุน COSMIC signatures (v2 ู v3).

5.4 ุชูุณูุฑ ุฃูู ุงูุจุตูุงุช (APOBEC, MMR defect, POLE mutations).

## **๐ ุงูุฎูุงุตุฉ:**
ูุฐุง ุงูุชุญููู ูููููุง ูู ุฑุณู ุตูุฑุฉ ุดุงููุฉ ุนู ุงููุดูุฏ ุงูุฌููููู ูููุฑูุ ุจุฏุกูุง ูู ุงูุทูุฑุงุช ุงููุฑุฏูุฉ ุฅูู ุงูุจุตูุงุช ุงูุทูุฑูุฉ ุงููุงููุฉุ ูุน ุชูุณูุฑ ุจููููุฌู ูุณุฑูุฑู ูุญุชูู.
ูุฐู ุงููุนูููุงุช ุฃุณุงุณูุฉ ูููู ุขููุงุช ูุดูุก ุงููุฑู (tumorigenesis) ูุชุญุฏูุฏ ุฃูุฏุงู ุนูุงุฌูุฉ ูุญุชููุฉ (ูุซู ุงูุฃูุฑุงู ุฐุงุช MMR-deficiency ุฃู POLE mutations ุงูุชู ุชุณุชุฌูุจ ููุนูุงุฌ ุงูููุงุนู).

___
___

โจ ุจูุฐุง ูููู ูุฏ ุฃููููุง ุงูู workflow ุงูุชุญูููู ุจุงุณุชุฎุฏุงู maftools.




















