---
title: 'ุงูููู ุงูุฃูู: ููุฏูุฉ ููุบุฉ R ุงูุจุฑูุฌูุฉุ ูุน ุชูุธูู ุงูุจูุงูุงุช ูุชุฑุชูุจูุง'
output:
  html_document:
    lang: ar
    css: ../sc/style.css
    df_print: paged
  pdf_document: default
editor_options:
  markdown:
    wrap: sentence
---

------------------------------------------------------------------------

## 1. ุณูููู ุจุชููุฆุฉ ุจูุฆุฉ ุงูุนููุ ุซู ูุญููู ุงูุญุฒู ุงูุจุฑูุฌูุฉ ุงูุชู ุณูุญุชุงุฌ ุฅูููุง ุฃุซูุงุก ูุฐู ุงููุฑุดุฉ.

<br><br>

**library(maftools)**: ุญุฒูุฉ ูููุฉ ูู ูุบุฉ R ูุฎุตุตุฉ ูุชุญููู ุจูุงูุงุช Mutational Annotation Format (MAF) ุงูุฎุงุตุฉ ุจุงูุชุญูููุงุช ุงูุฌูููููุฉ (ุฎุตูุตูุง ุจูุงูุงุช ุงูุทูุฑุงุช ุงูุฌุณุฏูุฉ ูู ุชูููุงุช ุงูู NGS).
ุชูุณุชุฎุฏู ุงูุญุฒูุฉ ุจูุซุฑุฉ ูู ูุฌุงู ุงููุนูููุงุชูุฉ ุงูุญูููุฉ (Bioinformatics) ูุชูุฎูุต ุจูุงูุงุช ุงูุทูุฑุงุชุ ูุงุณุชุฎุฑุงุฌ ุฅุญุตุงุกุงุชุ ูุฅูุดุงุก ุฑุณููุงุช ุจูุงููุฉ ุชูุงุนููุฉ/ุงุณุชูุดุงููุฉ.
ููุงุทููุงุน ุนูู ุงูุชูุซูู ุงูุชูุตูููุ ููููู ุฒูุงุฑุฉ ุงูุฑุงุจุท ุงูุชุงูู:

๐ <https://github.com/PoisonAlien/maftools>

**library(ggplot2)**: ูููู ูุฐุง ุงูุฃูุฑ ุจุชุญููู ุงูุญุฒูุฉ ggplot2ุ ููู ูุธุงู ููู ููุฑู ูุฅูุดุงุก ุฑุณูู ุจูุงููุฉ ุซุงุจุชุฉ ูู ูุบุฉ R.
ููุงุทููุงุน ุนูู ุงูุชูุซูู ุงูุชูุตูููุ ููููู ุฒูุงุฑุฉ ุงูุฑุงุจุท ุงูุชุงูู:

๐ <https://ggplot2.tidyverse.org/>

**library(skimr)**: ุญุฒูุฉ ูุฎุตูุตุฉ ูุชูููุฏ ููุฎุตุงุช ูุตููุฉ ุณุฑูุนุฉ ูุซุฑูุฉ ููุจูุงูุงุช (summary statistics) ุจุทุฑููุฉ ููุธูุฉ ูุณููุฉ ุงููุฑุงุกุฉ.ููุงุทููุงุน ุนูู ุงูุชูุซูู ุงูุชูุตูููุ ููููู ุฒูุงุฑุฉ ุงูุฑุงุจุท ุงูุชุงูู:

๐ <https://docs.ropensci.org/skimr>

**library(dplyr)**: ุฒูุฉ ูููุฉ ููุณุชุฎุฏูุฉ ุนูู ูุทุงู ูุงุณุน ูู ูุบุฉ R ููุนุงูุฌุฉ ุงูุจูุงูุงุช (data manipulation).ููุงุทููุงุน ุนูู ุงูุชูุซูู ุงูุชูุตูููุ ููููู ุฒูุงุฑุฉ ุงูุฑุงุจุท ุงูุชุงูู:

๐ <https://dplyr.tidyverse.org>

**library(tidyverse)**: ุชูุญูููู ูุฌููุนุฉ ูุชูุงููุฉ ูู ุงูุญุฒู ุงููุตููุฉ ูุชุณููู ุชุญููู ุงูุจูุงูุงุช ูู R.ููุงุทููุงุน ุนูู ุงูุชูุซูู ุงูุชูุตูููุ ููููู ุฒูุงุฑุฉ ุงูุฑุงุจุท ุงูุชุงูู:

๐ <https://www.tidyverse.org>

```{r Setting up the environment}
library(maftools)
library(dplyr)
library(skimr)
library(tidyverse)
library(ggplot2)
```

## 2. ูุฑุงุกุฉ ุงูุจูุงูุงุช ุงููุตููุฉ (metadatat)ุ ูุงูุชุนุฑู ุนูููุงุ ูุฑุณููุง ูููุฎุตุงุช

<br><br>

### 1๏ธโฃ ูุฑุงุกุฉ ุงูุจูุงูุงุช ุงููุตููุฉ ูุงูุงูููููููุฉ:

```{r Loading Data}
url <- "https://raw.githubusercontent.com/Dalah-Info/health-info-bioinformatics-r/refs/heads/main/metadata/breast_tumor_metadata.csv"
Breast_tumor_metadata <- read.csv(url)
#ุงุณุชูุดุงู ุงูุจูุงูุงุช
head(Breast_tumor_metadata)
```

### 2๏ธโฃ ูุนุฑูุฉ ุนุฏุฏ ุงูุฃุนูุฏุฉ ูุงูุตูููุ ุญูุซ:

<br><br> **ุงูุฃุนูุฏุฉ:** ุนุฏุฏ ุงูุจูุงูุงุช ุงููุตููุฉ ูุงูุงูููููุฉ ุงูุชู ุชู ุฌูุนูุง.
<br><br> **ุงูุตููู:** ุนุฏุฏ ุงููุฑุถู.

```{r exlore metadata}

print(paste("Number of clinical data:", ncol(Breast_tumor_metadata)))
print(paste("Number of patients:", nrow(Breast_tumor_metadata)))
```

### 3๏ธโฃ ุชูุธูู ุงูุจูุงูุงุช

ุณูููู ุจูุฑุงุกุฉ ุฌููุน ุงูุฃุนูุฏุฉ ูุชูุฎูุตูุงุ ูุฐูู ุจูุฏู ุชุญุฏูุฏ ุงูุฃุนูุฏุฉ ุงูุชู ููุจุบู ุฅุฒุงูุชูุงุ ูุซู:

-   ุงูุฃุนูุฏุฉ ุงูุชู ุชุญุชูู ุนูู ุจูุงูุงุช ููููุฏุฉ ุจูุณุจุฉ ุชุชุฌุงูุฒ 50% (ูุฏ ุชููู ุงูููู ุงูููููุฏุฉ ูุณุฌููุฉ ููุณุงูุฉ ุจูุถุงุกุ ุฃู NAุ ุฃู ูุงุฑุบุฉ).

-   ุงูุฃุนูุฏุฉ ุบูุฑ ุงููููุฏุฉ ููุชุญูููุ ูุซู ุฃุนูุฏุฉ ุชุงุฑูุฎ ุงูุฅุฏุฎุงู ุฃู ุงูุชุณุฌูู.

-   ุงูุฃุนูุฏุฉ ุงูุชู ุชุญุชูู ุนูู ูููุฉ ูุงุญุฏุฉ ููุฑุฑุฉ ูุฌููุน ุงููุฑุถู.

ูุงูุชุดุงู ูุฐู ุงูุญุงูุงุช ุจุณูููุฉุ ุณูุณุชุฎุฏู ุญุฒูุฉ **skimr** ุงูุชู ุชูููุฑ ููุฎุตูุง ุดุงูููุง ููู ุนููุฏ ูู ููู ุงูุจูุงูุงุชุ ููุง ูุณุงุนุฏ ุนูู ุชุญุฏูุฏ ุงูุฃุนูุฏุฉ ุงููุงุฑุบุฉ ุฃู ุบูุฑ ุงููููุฉ.

```{r Skim metadata}

skimr::skim(Breast_tumor_metadata)

```

ูููู ุงูุขู ุจุฅุฒุงูุฉ ุงูุฃุนูุฏุฉ ุฐุงุช ุงูุฅุดูุงู ููุฑูุฒ ุนูู ุงูุฃุนูุฏุฉ ุงููููุฉ ููุท.

```{r clean metadata}
# ุฃุนูุฏุฉ ูุง ุชุญุชูู ุนูู ููู
Breast_tumor_metadata$primary_therapy_outcome_success <- NULL 
Breast_tumor_metadata$eastern_cancer_oncology_group <- NULL
Breast_tumor_metadata$residual_tumor <- NULL
Breast_tumor_metadata$tumor_thickness <- NULL

#ุนููุฏ ูุญุชูู ุนูู ูููุฉ ูุงุญุฏุฉ ููุท ููู ุงููุฑุถู
Breast_tumor_metadata$days_to_initial_pathologic_diagnosis <- NULL

```

ุนุฏุฏ ุงูุฃุนูุฏุฉ ุงููุตููุฉ ุจุนุฏ ุฅุฒุงูุฉ ุงูุฃุนูุฏุฉ ุบูุฑ ุงููููุฉ:

```{r exlore metadata 2}

print(paste("Number of clinical data:", ncol(Breast_tumor_metadata)))
```

ููุฑุฃ ุฃุณูุงุก ุงูุฃุนูุฏุฉ ููุณูุชุดู ููุฑุณู ุจุนุถูุง:

```{r exploratory analysis}

colnames(Breast_tumor_metadata)

```

๐ต Gender information:

```{r exploratory analysis- Gender}

table_gender <- table(Breast_tumor_metadata$gender) 

barplot(table_gender,
        main = "Gender distribution of breast tumor cases",
        ylab = "Count",
        col = c("pink", "lightblue"))

```

๐ต Vital status information:

```{r exploratory analysis - Vital Status}

table_vital_status <- table(Breast_tumor_metadata$vital_status) 

barplot(table_vital_status,
        main = "Vital status of patients",
        ylab = "Count",
        col = c("lightgreen", "tomato"))

```

๐ต New tumor events after treatment information:

```{r exploratory analysis - New tumor after treatment}

table_event <- table(Breast_tumor_metadata$new_tumor_event_after_initial_treatment)

barplot(table_event,
        main = "New tumor event after initial treatment",
        ylab = "Count",
        col = c("gray70", "gray90", "lightblue", "tomato"),
        las = 2)   # rotate labels so they don't overlap

```

๐ต Radiation therapy status:

```{r exploratory analysis - Radiation therapy}

table_radiation <- table(Breast_tumor_metadata$radiation_therapy)

barplot(table_radiation,
        main = "Radiation therapy status",
        ylab = "Count",
        col = c("orange", "gray70", "gray90", "lightblue", "tomato"),
        las = 2)  # rotate labels for readability
```

๐ต Histological types of breast tumors:

```{r exploratory analysis - histological subtypes}

table_hist <- sort(table(Breast_tumor_metadata$histological_type), decreasing = TRUE)

df_hist <- as.data.frame(table_hist)

ggplot(df_hist, aes(x = Var1, y = Freq)) +
  geom_col(fill = "skyblue") +
  coord_flip() +
  labs(title = "Histological types of breast tumors",
       x = "Histological type", y = "Count") +
  theme_minimal() +
  theme(axis.text.y = element_text(size = 8))

```

๐ต Pathological stage of breast tumors:

```{r exploratory analysis - pathological stage}

table_stage <- sort(table(Breast_tumor_metadata$pathologic_stage), decreasing = TRUE)

df_stage <- as.data.frame(table_stage)

names(df_stage) <- c("Stage","Count")

ggplot(df_stage, aes(x = reorder(Stage, Count), y = Count)) +
  geom_col(fill = "skyblue") +
  coord_flip() +
  labs(title = "Pathologic stage", x = NULL, y = "Count") +
  theme_minimal() +
  theme(axis.text.y = element_text(size = 9))

```
